@model HovedOppgave.Models.ImportFiles

@{
    ViewBag.Title = "Importer Sertifikat";
}

<h2>Importer Sertifikat</h2>
<br />
<div class="col-lg-offset-3">
    <div class="btn-group" role="group">
        <button type="button" class="btn btn-default" onclick="Overview()">Oversikt</button>
        <button type="button" class="btn btn-default" onclick="Create()">Registrer ny enhet</button>
        <button type="button" class="btn btn-default" onclick="History()">Logg</button>
        <button type="button" class="btn btn-default" onclick="License()">Sertifikat</button>
    </div>
</div>
<br />
@using (Html.BeginForm("Import", "Kalibrering", FormMethod.Post, new { enctype = "multipart/form-data" }))
{
    <input type="file" class="btn btn-default" id="fileInput" name="file"/>
    <input type="button" value="Vis fil" class="btn btn-default" id="show"/>
    <br />
    <div class="frameDiv">
        <iframe width="860" height="1070" id="iFrame" hidden="hidden" src=""></iframe>
    </div>
    <br />
    <h4>Settes til hvilken enhet med kalibrering?</h4>
    <div class="form-group">
        @Html.LabelFor(model => model.Device, htmlAttributes: new { @class = "control-label col-md-2" })
        <div class="col-md-10" id="device">
            @Html.DropDownListFor(model => model.SelectedDevice, Model.Device, new { @class = "form-control" })
            @Html.ValidationMessageFor(model => model.Device, "", new { @class = "text-danger" })
        </div>
    </div>
    <br /><br />
    <input type="submit" value="Lagre" hidden="hidden" id="save" class="btn btn-default" />
}
<script type="text/javascript">
    $(document).ready(function () {
        $('#show').click(function (e) {
            var files = document.getElementById("fileInput");
            var file;
            for (i = files.files.length - 1; i < files.files.length; i++) {
                    file = files.files[i];
            }
            var href = URL.createObjectURL(file);
            e.preventDefault();
            $('#iFrame').attr("src", href + "#view=VFit" + "&toolbar=0" + "&navpanes=0");
            $('.frameDiv').show();
            iFrame.hidden = false;
            edit.hidden = false;
            save.hidden = false;
            URL.revokeObjectURL(file);
        });
    });

    function Create() {
        window.location.replace("/Kalibrering/Create");
    };

    function Overview() {
        window.location.replace("/Kalibrering/Overview");
    };

    function License() {
        window.location.replace("/Kalibrering/License");
    };

    function History() {
        window.location.replace("/Kalibrering/History");
    };
</script>

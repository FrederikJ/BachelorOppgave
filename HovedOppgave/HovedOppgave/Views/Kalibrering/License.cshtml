@model HovedOppgave.Models.CalibrationViews

@{
    ViewBag.Title = "Kalibrerings sertifikat";
}

<h2>Kalibrering sertifikat</h2>

<br />
<div class="col-lg-offset-3">
    <div class="btn-group" role="group">
        <button class="btn btn-default dropdown-toggle" onclick="getColName()" id="menu" data-toggle="dropdown">
            Gjem Kolonner
            <span class="caret"></span>
        </button>
        <ul class="dropdown-menu" role="menu" aria-labelledby="menu" id="ddm" onclick="checkColName()"></ul>
        <button type="button" class="btn btn-default" onclick="Overview()">Oversikt</button>
        <button type="button" class="btn btn-default" onclick="Create()">Registrer ny enhet</button>
        <button type="button" class="btn btn-default" onclick="History()">Logg</button>
        <button type="button" class="btn btn-default" onclick="Import()">Importering</button>
    </div>
</div>
<br />
<div id="tableContainer"></div>
<a class="fancybox" id="showFile" data-fancybox-type="iframe" href="~/App_Data/Sertifikat/Fabrikantsertifikat_eks_1.pdf">hei</a>
<script type="text/javascript">
    var th, tb;
    var asc1 = 1, asc2 = 1, asc3 = 1;

    $(document).ready(function () {
        $(".fancybox").fancybox();

        var h4 = document.createElement("h4");
        h4.textContent = "Fil plassering";
        var hr = document.createElement("hr");
        var div = document.createElement("div");
        div.className = "col-lg-12";
        var lable = document.createElement("lable");
        var filePath = @Html.Raw(Json.Encode(Model.FilePath));
        lable.textContent = filePath;
        div.appendChild(lable);

        var br = document.createElement("br");
        var brr = document.createElement("br");

        var table = document.createElement("table");
        table.className = "table";
        var thead = document.createElement("thead");
        thead.setAttribute("id", "thead");
        var tbody = document.createElement("tbody");
        tbody.setAttribute("id", "tbody");

        FillTableHead(thead, "file");

        var fileList = @Html.Raw(Json.Encode(Model.Files));
        jQuery.each(fileList, function(i, file) {
            tr = document.createElement("tr");

            var td = document.createElement("td");
            td.textContent = String(file["FileName"]);
            tr.appendChild(td);

            td = document.createElement("td");
            td.textContent = String(file["FileType"]);
            tr.appendChild(td);

            td = document.createElement("td");
            td.textContent = String(file["FileSize"]);
            tr.appendChild(td);

            td = document.createElement("td");
            var date = new Date($.parseJSON(String(file["Date"]).substr(6, 13)));
            var month = date.getMonth() + 1;
            td.textContent = String(date.getDate() + "." + month + "." + date.getFullYear());
            tr.appendChild(td);

            var id = file["FileID"];
            var td = document.createElement("td");

            var inputShow = document.createElement("button");
            inputShow.type = "button";
            inputShow.className = "btn btn-success";
            inputShow.textContent = "Vis fil";
            inputShow.onclick = function() {
                //showFile.hidden = false;
                //$("#showFile").href= "@Model.FilePath" + "/" + file["FileName"];

            };

            var inputDet = document.createElement("button");
            inputDet.type = "button";
            inputDet.className = "btn btn-warning";
            inputDet.textContent = "Detaljer";
            inputDet.onclick = function(){
                window.location.replace("/Kalibrering/Detailsfile/" + id);
            };

            var inputDel = document.createElement("button");
            inputDel.type = "button";
            inputDel.className = "btn btn-danger";
            inputDel.textContent = "Slett fil";
            inputDel.onclick = function() {
                window.location.replace("/Kalibrering/Deletefile/" + id);
            };

            var group = document.createElement("div");
            group.className = "btn-group";
            group.appendChild(inputShow);
            group.appendChild(inputDet);
            group.appendChild(inputDel);

            td.appendChild(group);
            tr.appendChild(td);

            tbody.appendChild(tr);

            AddTableToContainer(thead, tbody, h4, table, hr, div, br, brr);
        });

        $("#ddm").click(function() {
            var colNumber = event.path[1].id;
            var el = document.getElementById(colNumber);
            var checkInput = el.getElementsByTagName('input');
            CheckColName(colNumber, th, tb, checkInput);
        });

        $("#menu").click(function() {
            GetColName(th);
        });
    });

    function Overview() {
        window.location.replace("/Kalibrering/Overview");
    };

    function Create() {
        window.location.replace("/Kalibrering/Create/" + 0);
    };

    function Import() {
        window.location.replace("/Kalibrering/Import/" + 0);
    };

    function History() {
        window.location.replace("/Kalibrering/History");
    };
</script>